[Welcome to IGNNITION — ignnition main documentation](https://ignnition.org/doc/)

# IGNNITION: Bridging the Gap Between Graph Neural Networks and Networking Systems

• Pujol-Perich D, Suárez-Varela J, Ferriol M, et al. **IGNNITION: Bridging the Gap Between Graph Neural Networks and Networking Systems[J]**. IEEE Network, 2021. [Link](https://arxiv.org/abs/2109.06715v1) [Code](https://ignnition.org/doc/)

## IGNITION: 그래프 신경망과 네트워킹 시스템 간의 격차 해소

- IGNNITION: Bridging the Gap Between Graph Neural Networks and Networking Systems
    
    [2109.06715v1.pdf](https://prod-files-secure.s3.us-west-2.amazonaws.com/60b7a12c-d798-4819-a350-0b02a52409b9/c4a86188-d642-48fb-a9e9-833775ed683d/2109.06715v1.pdf)
    

## ***Abstract***

<aside>
💡 이 글에서는 그래프가 중요한 역할을 하는 네트워킹을 비롯한 다양한 분야에서 그래프 신경망(GNN)의 잠재력에 대해 설명한다. GNN은 학습 중에 보이지 않는 네트워크에 일반화할 수 있는 능력이 있어 네트워킹 분야의 실제 머신 러닝(ML) 솔루션에 유용하다. 그러나 강력한 ML 전문 지식이 없는 네트워크 엔지니어에게는 GNN 프로토타입을 구현하는 것이 어려울 수 있다. 이 글에서는 이 문제를 해결하기 위해 **네트워킹 시스템용 GNN 프로토타입을 간소화하는 오픈 소스 프레임워크인 IGNNITION**을 소개하며, 이 프레임워크는 맞춤형 GNN 아키텍처를 구축할 수 있는 유연성을 제공하는 동시에 TensorFlow의 기본 구현과 비슷한 정확도와 성능을 달성할 수 있다.

</aside>

## INTRODUCTION

<img width="304" alt="5" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/55618ddd-23ca-4e38-9da4-2bc0afd67898">

 그래프 신경망(GNN)은 그래프로 표현된 정보를 학습하고 일반화할 수 있는 능력으로 인해 머신 러닝(ML) 분야에서 큰 주목을 받고 있다. 그 결과 데이터가 본질적으로 그래프로 구성되어 있는 화학, 물리학, 생물학, **추천 시스템, 소셜 네트워크** 등 다양한 영역에서 혁신적인 애플리케이션이 개발되었다. GNN은 그래프 구조의 데이터에서 가치 있는 인사이트를 분석하고 추출할 수 있는 강력한 도구를 제공하여 이러한 분야의 발전에 기여하고 있다.

 최근 몇 년 동안 토폴로지 및 라우팅과 같은 **기본적인 네트워킹 문제와 관련된** 고유한 그래프 구조로 인해 네트워킹에서 그래프 신경망(GNN)을 활용하는 것에 대한 관심이 높아지고 있다. GNN은 라우팅 최적화, 가상 네트워크 기능 배치, 무선 네트워크의 리소스 할당과 같은 다양한 네트워킹 애플리케이션에서 가능성을 보여주었다. 훈련 중에 보이지 않는 네트워크에 일반화할 수 있는 GNN은 재훈련 없이 다양한 네트워크 환경에 배포할 수 있는 머신 러닝 기반 솔루션을 개발하는 데 유용한 도구이다.

 그래프 신경망(GNN) 모델을 설계하고 구현하려면 복잡한 수학적 공식과 텐서플로우나 파이토치 같은 머신 러닝 라이브러리를 사용해야 한다. 또한, 네트워킹을 위한 GNN 모델은 서로 다른 요소 간에 순차적 종속성이 있는 그래프와 같은 비표준 아키텍처를 필요로 하는 경우가 많아 구현이 더욱 복잡해진다. 이는 GNN의 이점을 누릴 수 있지만 이러한 모델을 구현하는 데 필요한 머신 러닝 전문 지식이 부족한 네트워크 연구자와 엔지니어에게 상당한 도전 과제이다.

 이 글에서는 신경망 프로그래밍에 대한 지식이 부족한 네트워킹 전문가와 연구원도 쉽게 자체 그래프 신경망(GNN) 모델을 설계할 수 있는 **TensorFlow 기반의 오픈 소스 프레임워크인 IGNNITION을 소개한다.** 사용자는 직관적인 YAML 파일을 사용하여 복잡한 네트워크 시나리오에 대해 원하는 GNN 아키텍처를 지정할 수 있으며, 이그니션은 수동 코딩 없이도 GNN의 효율적인 TensorFlow 구현을 자동으로 생성한다. **이 프레임워크는 GNN 프로토타이핑 프로세스를 간소화하고 네트워킹 애플리케이션을 위한 실용적인 머신 러닝 솔루션 개발을 용이하게 해준다**.

 네트워킹에서 그래프 신경망(GNN) 모델의 커스터마이징과 유연성을 향상시키기 위해 **다단계 메시지 전달(MSMP) 그래프라는 고수준 추상화가 제안되었다**. 이 추상화를 통해 다양한 GNN 변형을 설계하고 여러 구성 요소를 조합할 수 있으며, 복잡한 수학 공식과 텐서 연산을 숨겨 구현을 단순화할 수 있다. MSMP 그래프는 네트워크 엔지니어와 실무자에게 네트워킹 애플리케이션에 맞는 맞춤형 GNN 모델을 쉽게 구현할 수 있는 코딩 없는 인터페이스를 제공한다.

 **IGNITION은 네트워크 엔지니어와 실무자가 네트워킹 맥락에서 맞춤형 그래프 신경망(GNN) 모델을 구현할 수 있도록 YAML 파일에 기반한 코딩 없는 인터페이스를 제공하는 툴이다.** 이 접근 방식은 더 복잡하고 저수준 추상화가 필요할 수 있어 신경망 프로그래밍 비전문가에게는 어려울 수 있는 범용 GNN 라이브러리를 사용하는 것에 비해 코딩 프로세스를 간소화한다. 또한 이러한 라이브러리 중 일부는 네트워킹 애플리케이션을 위해 특별히 설계된 비표준 GNN 아키텍처를 구현하는 데 필요한 유연성이 부족할 수 있다.

### 결론

본 논문의 소개 섹션은 주로 그래프 구조 데이터를 처리할 수 있는 능력으로 인해 네트워킹을 포함한 여러 분야에서 GNNs의 중요성이 증가하고 있다는 것에 중점을 둔다. 이는 IGNNITION 프레임워크를 통해 특히 네트워킹 시스템에서 효율적으로 GNN 모델을 개발할 수 있는 솔루션으로 소개하며, 이의 다양성과 기본 TensorFlow 구현과의 성능 동등성을 강조한다.

## BACKGROUND ON GNN

 그래프 신경망(GNN)의 맥락에서 입력은 노드와 에지로 구성된 그래프이다. 각 노드에는 내부 상태를 나타내는 숨겨진 상태 벡터가 있다. GNN이 실행을 시작하면 숨겨진 상태 벡터는 입력 그래프의 노드 관련 기능으로 초기화된다. 그래프 신경망(GNN)에서 숨겨진 상태 벡터를 초기화한 후 입력 **그래프의 연결을 기반으로 메시지 전달 알고리즘이 실행된다.** 이 알고리즘에는 **메시지 교환, 집계 및 업데이트의 세 가지 주요 단계가** 포함된다. 메시지 교환 단계에서는 각 노드가 이웃 노드에 메시지를 보낸 다음 이러한 메시지를 집계하고 각 노드의 숨겨진 상태를 업데이트한다.

<img width="309" alt="4" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/bfd2bb09-745d-439c-81ab-637e0bfe8c38">

<aside>
💡 1. **메시지 교환:** 각 노드는 그래프 내의 모든 이웃에게 메시지를 보낸다. 이 메시지는 발신 노드 *hv*와 수신 이웃 *hu*의 히든 상태를 결합한 결과이다.

1. **집계:** 수신된 메시지들이 각 노드에 대한 새로운 히든 상태를 계산하기 위해 집계된다.
2. **업데이트:** 노드들의 히든 상태는 집계된 메시지를 기반으로 업데이트된다
</aside>

 그래프 신경망(GNN)의 메시지 전달 단계에서는 각 노드가 자신의 숨겨진 상태와 이웃 노드의 숨겨진 상태를 결합하여 이웃 노드에 메시지를 보낸다. 그런 다음 이러한 메시지는 집계 함수(일반적으로 요소별 합산)를 사용하여 단일 벡터로 집계된다. 마지막으로 각 노드는 자신의 숨겨진 상태를 집계된 메시지와 결합하여 업데이트한다. 이 프로세스는 노드의 숨겨진 상태가 안정적인 값으로 수렴할 때까지 여러 번 반복된다.

**모델 예측**

그래프 신경망(GNN)의 메시지 전달 단계가 끝나면 모델의 최종 예측을 생성하기 위해 판독 함수가 적용된다. 이 함수는 노드의 숨겨진 상태를 입력으로 받아 전역 그래프 수준의 속성 또는 특정 노드 수준의 특징으로 변환된다. 판독 함수는 메시지 전달 반복을 통해 학습된 표현을 기반으로 GNN 모델의 출력을 생성하는 데 중요한 역할을 한다. 

 그래프 신경망(GNN)에서 메시지, 업데이트, 판독과 같이 아키텍처를 정의하는 내부 기능은 신경망(NN)을 사용하여 모델링된다. 피드포워드 또는 순환 신경망과 같은 이러한 NN은 입력 그래프의 노드와 연결을 기반으로 GNN 내에서 동적으로 결합된다. 이러한 NN은 훈련 중에 내부 파라미터를 공동으로 최적화하여 각 노드의 관점에서 목표 함수를 학습하므로 다양한 크기와 구조를 가진 그래프에 대해 정확한 예측을 할 수 있다.

이 섹션에서 제공하는 그래프 신경망(GNN)에 대한 기본적인 설명 외에도 그래프 컨볼루션 네트워크, 게이트 신경망, 그래프 주의 네트워크, 그래프 순환 신경망, GraphSAGE 등 다양한 GNN 아키텍처 변형이 존재한다. 이러한 변형은 서로 다른 특성을 가지고 있지만, 모두 초기 메시지 전달 단계와 최종 판독이라는 기본 원칙을 따른다. GNN에 대한 보다 포괄적인 정보는 인용된 참고 문헌 [1] 및 [2]를 참조하시기 바란다.

## THE MSMP GRAPH ABSTRACTION

 네트워킹 분야에서는 특정 네트워킹 시나리오를 처리하기 위해 그래프 신경망(GNN) 모델을 사용자 정의하는 경우가 많다. 이러한 모델은 비표준 메시지 전달 아키텍처를 통합하여 서로 다른 네트워크 요소 간의 상호 의존성을 명시적으로 포착한다. 네트워킹을 위한 최신 GNN 모델은 전달 장치, 링크, 경로 등 다양한 요소 유형이 포함된 이기종 그래프를 활용하고, 특정 요소 집합이 다른 요소와 숨겨진 상태를 공유하는 여러 단계로 구분된 사용자 정의 메시지 전달 정의를 사용한다.

 DGL이나 PyTorch Geometric과 같은 기존의 범용 GNN 라이브러리는 사용자 정의 GNN 모델을 구현하기 위한 높은 수준의 추상화를 제공하지만, 네트워킹을 위한 최신 GNN 모델의 공통 프레임워크인 다단계 메시지 전달 정의에 대한 직접적인 지원이 부족하다. 이러한 제한으로 인해 이러한 모델을 구현하려면 더 낮은 수준의 추상화를 사용해야 하며, 더 많은 수동 구현과 사용자 정의가 필요하다.

 이그니션은 네트워킹을 위한 GNN 모델 구현을 간소화하기 위해 **다단계 메시지 전달 그래프(MSMP 그래프)라는 고수준 추상화를 도입**했다. 이 추상화를 통해 사용자는 복잡한 수학적 공식을 파고들 필요 없이 그래프 표현을 사용하여 시각적으로 맞춤형 GNN 아키텍처를 정의할 수 있다. 사용자는 일련의 요소 유형과 그 순차적 관계를 정의함으로써 자연스럽고 직관적으로 GNN 모델에 대한 다단계 메시지 전달 체계를 만들 수 있다.

<img width="313" alt="3" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/3facc300-e7fb-4b58-b261-07f40c32d8b5">

주어진 컨텍스트에서 그림 3(왼쪽)은 세 개의 그래프 엔티티(e1, e2, e3)가 있는 MSMP(다단계 메시지 전달) 그래프의 일반적인 예시를 제공한다. 이 그래프는 메시지 전달의 두 단계를 보여주는데, 첫 번째 단계에서는 e1 및 e2 유형의 요소가 숨겨진 상태를 e3 유형의 이웃 요소로 보내고, 두 번째 단계에서는 e3 유형의 요소가 연결된 e1 및 e2 유형의 요소와 자신의 상태를 공유한다. 그림 3(오른쪽)은 두 개의 그래프 엔티티(링크와 경로)를 포함하고 이러한 엔티티 간의 순환 의존성을 나타내는 2단계 메시지 전달 체계를 구현하는 RouteNet의 MSMP 그래프를 보여준다. 메시지 전달, 집계, 업데이트, 판독에 대한 특정 함수는 사용자가 YAML의 모델 설명 파일을 사용하여 정의하며, MSMP 그래프는 사용자가 IGNITION을 사용하여 정의한 지정된 반복 횟수 동안 언롤링할 수 있는 GNN(그래프 신경망)의 단일 반복을 설명한다.

본문에서 설명한 MSMP 그래프 추상화는 메시지 전달 신경망, 그래프 컨볼루션 네트워크, 게이트 신경망, 그래프 주의 신경망, 그래프 반복 네트워크 등 기존의 다양한 GNN 변형을 지원하는 유연한 설계를 제공한다. 또한 메시지 전달, 집계, 업데이트 및 정규화와 같은 이러한 변형의 개별 구성 요소를 사용자 정의 조합할 수 있다. 이 추상화는 **이 글을 쓰는 시점에 네트워킹에 적용된 모든 최신 GNN 모델을 지원하는 것으로 간주된다.**

### 결론

MSMP 그래프 추상화는 GNN 모델의 구현을 용이하게 하며, 다양한 GNN 변형의 설계와 새로운 사용자 정의 아키텍처의 생성에 있어 유연성을 제공한다. 이는 사용자가 복잡한 수학적 공식을 몰라도 GNN 모델을 쉽게 구현할 수 있게 해주며, IGNNITION 프레임워크와 결합하여 빠르고 효율적인 GNN 프로토타이핑을 가능하게 한다.

## IGNNITION ARCHITECTURE

 이 섹션에서는 네 가지 주요 빌딩 블록으로 구성된 프레임워크인 IGNITION에 대한 개요를 제공한다.

1.  모델 설명 인터페이스
2. 데이터 세트 인터페이스
3. 코어 엔진
4. 디버깅 어시스턴

 모델 설명 인터페이스를 통해 사용자는 다단계 메시지 전달 그래프(MSMP 그래프) 추상화를 사용하여 그래프 신경망(GNN)의 아키텍처를 설명할 수 있다. 데이터 세트 인터페이스는 훈련 및 평가를 위한 입력 데이터를 처리하고, 코어 엔진은 GNN 모델의 계산과 훈련을 수행한다. 디버깅 어시스턴트는 개발 과정에서 문제를 식별하고 해결하는 데 도움을 준다.

### 주요 특징:

- **고수준 추상화:** IGNNITION은 MSMP 그래프와 YAML 파일을 기반으로 한 코드리스 인터페이스를 제공하여 GNN의 수학적 공식과 구현을 추상화한다.
- **디자인의 유연성:** MSMP 그래프 추상화를 통해 다양한 GNN 변형과 사용자 정의 메시지 전달 아키텍처를 지원한다.
- **고성능:** 네트워크 애플리케이션에 필수적인 성능을 제공하는 효율적인 GNN 구현을 제공한다.
- **쉬운 디버깅:** 고급 오류 검사 메커니즘과 GNN의 향상된 시각화를 통해 네트워크 엔지니어가 모델을 문제 해결할 수 있게 돕는다.
- **쉬운 통합:** NetworkX 라이브러리를 기반으로 한 사용자 친화적인 데이터셋 인터페이스를 통해 GNN에 데이터를 공급할 수 있다.

### 작동 방식:

- IGNNITION은 사용자가 YAML 모델 설명 파일에서 쉽게 정의할 수 있는 파이프라인을 통해 제품 작업과 NN 함수를 쉽게 정의할 수 있게 해준다.
- 이 프레임워크는 TensorBoard를 활용하여 GNN 모델의 내부 아키텍처를 동적으로 시각화할 수 있게 해준다.
- 사용자는 이 시각화를 통해 GNN의 주요 구성 요소를 쉽게 식별하고 내부 함수가 어떻게 구현되는지 확인할 수 있다.

### 디버깅 시스템:

- IGNNITION은 사용자를 돕기 위해 고급 디버깅 시스템을 포함하고 있다.
- 이 시스템은 모델의 올바른 정의를 보장하고 잘못된 정의를 수정하는 데 도움을 주는 고급 오류 검사 메커니즘을 포함하고 있다.

### 성능:

- IGNNITION으로 구현된 GNN 모델의 성능은 기존의 TensorFlow 구현과 동등하다.
- 이 프레임워크는 네트워킹 애플리케이션의 효율성이 필수적이기 때문에, 이를 충족시키기 위해 설계되었다.

### 결론:

IGNNITION 아키텍처는 고수준의 추상화와 유연한 디자인, 고성능, 쉬운 디버깅, 그리고 쉬운 통합을 통해 네트워크 엔지니어와 실무자들이 GNN 모델을 쉽고 효과적으로 구현할 수 있게 해준다. 이 프레임워크의 도입으로 인해 사용자는 복잡한 수학적 공식과 텐서 연산을 몰라도 GNN을 구현할 수 있게 되었다.

## CASE STUDIES

<img width="310" alt="2" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/154c8b93-eb93-428a-a78c-233b2bd68a4e">

### IGNNITION과의 작업 흐름

이 섹션에서는 IGNNITION을 사용하여 특정 네트워크 문제에 적응된 GNN 모델을 생성하기 위한 일반적인 작업 흐름을 설명한다. 사용자(일반적으로 네트워크 엔지니어)는 처리해야 할 네트워킹 문제에 관련된 주요 요소(예: 장치, 링크, 앱, 경로)를 식별해야 하며, GNN 모델의 목적(예: 트래픽 엔지니어링)에 따라 이러한 다양한 요소 간의 잠재적인 종속성을 정의해야 한다. 네트워킹 맥락에서는 다양한 요소 간의 순환 종속성을 자주 찾을 수 있으며, 이는 메시지 전달 단계의 연속으로 GNN에서 자연스럽게 인코딩될 수 있다. 이러한 요소와 종속성은 GNN의 입력 그래프를 형성하여 학습을 위한 훈련, 검증 및/또는 테스트 데이터셋의 샘플 구조를 정의한다.

### 구현 및 효율성

IGNNITION 프레임워크는 내부적으로 TensorFlow에서 GNN 모델을 구현하여 이 ML 라이브러리에서 생성된 효율적인 계산 그래프를 활용한다. 이 섹션에서는 IGNNITION 구현과 TensorFlow에서 직접 코딩된 구현과의 직접 비교를 제공하며, 두 가지 최첨단 GNN 모델인 RouteNet과 GQNN을 고려합니다. 평가에는 IGNNITION에서 이러한 모델의 공개적으로 사용 가능한 구현과  기본 TensorFlow 구현을 참조로 사용한다. IGNNITION 구현의 RouteNet은 평균 상대 오차가 2.62 퍼센트이며, GQNN 구현의 정확도는 98.07 퍼센트이다. 이 두 수치 모두 원래의 TensorFlow 구현에서 얻은 결과와 일치하다. IGNNITION 구현의 실행 시간은 TensorFlow에서 구현된 원래 모델의 실행 시간과 동등하다.

<img width="268" alt="1" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/eea8f4e5-982c-4630-ae11-6604229641e9">

## RELATED WORK

이 섹션에서는 최근 몇 년 동안 다양한 실제 문제에 GNNs를 적용하는 데 있어 뛰어난 성과로 인해 여러 GNN 라이브러리가 등장하였다고 언급하고 있다. 가장 인기 있는 오픈 소스 라이브러리로는 DGL, PyTorch Geometric, 그리고 Graph Nets가 있습니다. 또한, NeuGraph는 GNN 모델의 실행을 병렬화하는데 중점을 둔 인기 있는 GNN 라이브러리로, 오픈 소스는 아니지만 언급되고 있다.

이러한 라이브러리들은 GNNs의 다양한 실제 문제에 대한 적용을 돕고 있으며, 이 섹션에서는 이러한 라이브러리들의 중요성과 그들이 어떻게 GNNs의 발전에 기여하고 있는지를 강조하고 있다. IGNNITION도 이러한 라이브러리들과 유사한 목적으로 개발되었으며, 이를 통해 사용자들은 GNN 모델을 보다 쉽게 구현하고 적용할 수 있다.

## CONCLUSION

이 논문에서는 IGNNITION이라는 새로운 프레임워크를 소개하고 있으며, 이 프레임워크는 사용자가 GNN 모델을 더 쉽게 구현하고 적용할 수 있게 돕는다. IGNNITION은 TensorFlow를 기반으로 하며, 이를 통해 효율적인 계산 그래프를 생성합니다. 이 프레임워크의 구현은 사용자에게 높은 수준의 정확도와 효율성을 제공하며, 기존의 TensorFlow 구현과 동일한 성능을 보인다.

또한, IGNNITION은 사용자가 potential bugs를 쉽게 수정할 수 있도록 고급 오류 확인 메커니즘과 디버깅 시스템의 시각적 표현을 제공합니다. 이러한 기능들은 사용자가 GNN 모델을 더욱 효과적으로 구현하고 적용할 수 있게 돕는다.

이 프레임워크는 GNN 모델의 다양한 네트워킹 사용 사례에 적용될 수 있으며, 이는 IGNNITION이 네트워킹 분야에서 GNN 모델의 구현과 적용을 대폭 단순화할 수 있음을 보여준다.