# A GNN-Based Supervised Learning Framework for Resource Allocation in Wireless IoT Networks
## 무선 IoT 네트워크에서 리소스 할당을 위한 GNN 기반 지도 학습 프레임워크


### ABSTRACT

 사물 인터넷(IoT)을 통해 물리적 장치를 무선 네트워크를 통해 연결할 수 있다. 디바이스 간(D2D) 통신이 IoT의 유망한 기술로 떠오르고 있지만, D2D 리소스 할당을 위한 기존의 솔루션은 일반적으로 계산이 복잡하고 시간이 많이 걸린다. 이러한 높은 복잡성은 무선 IoT 네트워크의 실제 구현에 큰 걸림돌이 된다. **이 문제를 지도학습 방식으로 해결하기 위해 그래프 신경망(GNN) 기반 프레임워크가 제안되었다**. 구체적으로 무선 네트워크는 바람직한 **통신 링크는 노드로**, **유해한 간섭 링크는 에지로 모델링되는 방향성 그래프로 모델링**된다. 제안된 프레임워크의 효과는 D2D 네트워크에서의 링크 스케줄링과 D2D 언더레이 셀룰러 네트워크에서의 공동 채널 및 전력 할당이라는 두 가지 사례 연구를 통해 검증된다. 시뮬레이션 결과는 제안된 프레임워크가 평균 합계율과 샘플 효율성 측면에서 벤치마크 체계보다 우수한 성능을 보임을 보여준다. 또한 제안된 GNN 접근 방식은 다양한 시스템 설정에 대한 잠재적 일반화 가능성과 손상된 입력 특징에 대한 견고성을 보여준다. 또한 실행 시간을 단 몇 밀리초로 단축하여 D2D 리소스 최적화를 가속화한다.

색인 용어 - 리소스 할당, 그래프 신경망(GNN), 링크 스케줄링, 장치 간(D2D), 사물 인터넷(IoT)

---

### 1. Introduction

 **Device-to-device (D2D) 통신**은 사물 인터넷(IoT) 에코시스템의 디바이스가 기지국과 같은 **중앙 에이전트에 의존하지 않고 서로 직접 통신할 수 있는 기술이다**. D2D 통신은 효율적인 리소스 활용과 장애에 대한 견고성 등의 이점을 제공한다. **그러나** 채널 할당 및 링크 스케줄링과 같은 D2D 통신의 리소스 할당 문제는 계산 복잡성으로 인해 최적으로 해결하기가 어렵다. 연구자들은 이러한 문제를 해결하고 복잡성을 줄이면서 최적에 가까운 결과를 얻기 위해 차선책 알고리즘을 제안했다.

 **최근에는** 무선 통신의 리소스 할당 문제를 해결하기 위해 **머신러닝(ML) 기법이 적용되어** 알고리즘 실행 시간을 개선하는 데 **활용되고 있다**. 리소스 관리를 위한 최적화 학습(LORM), 모방 학습 등 다양한 ML 기반 접근 방식이 무선 네트워크에서 리소스 할당을 위한 B&B(Branch-and-Bound) 알고리즘과 같은 알고리즘을 가속화하기 위해 제안되었다. 그러나 이러한 노력에도 불구하고 이러한 기술은 일반적으로 밀리초 범위의 완료 시간을 요구하는 무선 네트워크의 **실시간 요구 사항을 충족하기에는 여전히 부족**하다.

 머신 러닝(ML) 기술이 무선 통신 설계의 시간 복잡성을 개선하는 데 가능성을 보였지만, 무선 네트워크 토폴로지를 통합하는 것은 여전히 어려운 과제이다. 그러나 **그래프 이론을 적용**하면 무선 네트워크와 그래프 간의 고유한 유사성 때문에 이 문제를 해결하는 데 **도움이 될 수 있다.** 그래프 컬러링 알고리즘은 펨토셀 네트워크, 장기 진화 시스템에서의 D2D 통신, 셀룰러 네트워크에서의 D2D 통신 등 다양한 무선 네트워크 시나리오에서 리소스 할당 작업을 해결하는 데 성공적으로 사용되어 왔다.

 무선 네트워크의 경우 D2D 링크 스케줄링 문제를 해결하기 위해 **공간 컨볼루션 방식과 다층 분류기를 사용한 그래프 임베딩 방식이 제안**되었다. 공간 컨볼루션 방식은 각 그리드의 송신기와 수신기 수를 기반으로 밀도 그리드에 컨볼루션을 적용하고, 그래프 임베딩 방식은 거리 기반 특징을 가진 저차원 벡터를 사용하여 D2D 쌍을 표현한다. 그러나 공간 컨볼루션 방식은 대규모 훈련 데이터 세트가 필요하기 때문에 비용이 많이 들거나 비현실적일 수 있는 반면, **그래프 임베딩 방식은 수백 개의 훈련 샘플만 있으면 된다.**

 [19] 및 [20]에 언급된 작업은 거리를 고려하는 데 중점을 두지만 채널 정보를 통합하지 않기 때문에 작은 규모의 페이딩이 있는 시나리오에서 성능이 저하될 수 있다. 그래프 신경망(GNN)은 다양한 응용 분야에서 성공을 거두었으며 채널 상태 정보(CSI)와 같은 비유클리드 데이터를 효과적으로 활용할 수 있다. [22]에서는 최적의 전력 제어를 위해 간섭 그래프 컨볼루션 신경망이 제안되었고, [23]에서는 무선 자원 관리 문제를 해결하기 위해 확장되었으며, [24]에서는 무선 애드혹 및 셀룰러 네트워크에서 전력 최적화를 위한 랜덤 에지 그래프 신경망을 도입했다.

 참고 문헌 [22]-[24]에서 제안된 설계는 동종 무선 시스템으로 제한되며 이기종 IoT 시스템에는 적합하지 않을 수 있다. 또한 이러한 작업은 주로 연속 최적화 문제에 초점을 맞추었기 때문에 이산 최적화 문제를 효과적으로 처리하지 못할 수 있다. 반면, 본 연구에서는 이산 자원 최적화 문제를 구체적으로 다루는 일반적인 프레임워크를 도입하여 동종 네트워크에서 잘 작동하고 이기종 네트워크를 처리할 수 있는 잠재력을 보여준다.

<aside>
📍  무선 IoT 네트워크의 리소스 할당 문제를 해결하기 위해 GNN(그래프 신경망) 기반 프레임워크를 제안한다. 이 프레임워크는 네트워크를 **방향성 그래프**로 모델링하고 **CNN(컨볼루션 신경망)과 DNN(심층 신경망)의 조합**을 사용하여 특징 정보를 반복적으로 집계하고 결합한다. 제안된 프레임워크는 벤치마크 설계보다 성능이 뛰어나고, 제한된 훈련 샘플로 최적에 가까운 결과를 얻을 수 있으며, 다양한 네트워크 설정으로 일반화할 수 있는 잠재력을 가지고 있다.

</aside>

---

### 2. A GENERALIZED RESOURCE ALLOCATION PROBLEM
일반화된 리소스 할당 문제

 무선 IoT 네트워크에서 링크 스케줄링 및 채널 선택과 같은 리소스 할당 문제는 이산적 특성으로 인해 최적으로 해결하기가 어려울 수 있다. 이러한 문제에는 제약 조건을 충족하면서 사용자 연결 또는 채널 할당과 같은 리소스를 최적으로 할당하는 방법을 찾는 것이 포함된다. 각 액세스 포인트가 지원하는 디바이스 수, 개별 디바이스에 대한 서비스 품질 요구 사항 등의 제약 조건에 따라 네트워크 용량 또는 전력 소비와 같은 객관적 함수를 최소화하는 것이 목표이다. (예: 각 액세스 포인트가 지원할 수 있는 디바이스 수 및 개별 디바이스에 대한 서비스 품질 요구 사항)을 충족하면서 특정 성능 측정값(예: 네트워크 용량 또는 전력 소비)을 최소화하는 것

<img width="270" alt="1" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/0cbb121b-ec90-4335-b756-4b95ac3c84f3">


 무선 IoT 네트워크의 맥락에서 사용자 연결 또는 채널 할당과 같은 리소스 할당 문제를 이산 최적화 문제로 공식화할 수 있다고 설명한다. f(-)로 표시되는 목적 함수는 네트워크 용량 및 전체 전력 소비와 같은 시스템 성능을 측정한다. 변수 x는 리소스 할당에 대한 결정을 나타내며, gn(x) ≤ 0은 각 액세스 포인트에서 서비스하는 디바이스 수 및 개별 디바이스에 대한 서비스 품질 요구 사항과 같은 이산 변수 x와 관련된 제약을 나타낸다.

<aside>
📍 무선 IoT 네트워크에 3개의 액세스 포인트(AP)와 5개의 디바이스가 있는 시나리오를 생각해보자
목표는 리소스를 할당하는 것이며, 특히 어떤 디바이스가 어떤 AP에 연결되고 채널이 할당되는 방식을 결정하는 것이다.

목적 함수인 f(-)는 전체 네트워크 용량을 최대화하는 것으로 정의할 수 있다. 이 경우 네트워크를 통해 전송할 수 있는 데이터의 양을 측정한다.

의사 결정 변수 x는 리소스 할당을 나타낸다. 이를 행렬로 표현할 수 있다:

x = 
[[1, 0, 0],
[0, 1 ,0],
[1 ,0 ,1],
[0 ,1 ,0],
[1 ,0 ,1]]

이 예제에서는

- 장치 2는 AP2와 연결
- 장치 3은 두 AP와 모두 연결: AP1 및 AP3.

이제 gn(x) ≤로 표시되는 제약 조건은 여기서 n은 리소스 할당 결정 x와 관련된 다양한 제약 조건을 나타낸다:

예를 들어
gn(x) ≤ number_of_devices_per_AP_constraint
이 제약 조건은 각 액세스 포인트가 용량 제한 또는 해당 시스템 설정에 특정한 기타 요인으로 인해 제한된 수의 장치에만 서비스를 제공하도록 보장한다.

다른 제약 조건의 예는 다음과 같다:
GN(X) ≤ QoS_OF_SERVICE_CONFRICT
이 제약 조건은 리소스를 할당하는 동안 개별 디바이스가 최소 데이터 속도를 보장받거나 특정 서비스 품질 요구 사항을 충족하도록 보장한다.

</aside>

 그래프 신경망(GNN)을 기반으로 하는 프레임워크를 제안한다. 이 GNN 프레임워크는 엔드투엔드 학습을 활용하여 리소스 할당 문제를 효율적으로 해결한다. 제안된 프레임워크는 GNN의 성능을 활용하여 무선 IoT 네트워크에서 최적화 문제 해결의 성능과 계산 효율성을 향상시키는 것을 목표로 한다.

---

### **3. A GNN BASED FRAMEWORK FOR RESOURCE ALLOCATION IN WIRELESS NETWORKS**

### **무선 네트워크에서 리소스 할당을 위한 Gnn 기반 프레임워크**

 입출력 매핑을 학습하여 최적화 문제를 근사화하기 위한 **지도 신경망(GNN)**에 기반한 일반적인 프레임워크를 소개한다. 이 프레임워크는 **교차 엔트로피(CE)**라는 방법을 사용하여 훈련 샘플 생성을 간소화하고 무선 네트워크의 그래프 모델링을 설명한다. 그런 다음 이 프레임워크 내에서 지도 신경망(GNN)이 사용된다. 제안된 프레임워크의 그림은 그림 1과 같다.
****

<img width="370" alt="2" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/e8180cf3-51dc-4a2f-aac6-ba4688756c44">


<aside>
📍 통신을 위해 리소스를 공유해야 하는 많은 디바이스가 있는 무선 네트워크가 있다고 가정해 보자. 이러한 리소스를 할당하는 방법을 결정하는 일반적인 방법은 복잡하고 시간이 오래 걸린다.

이 문제를 해결하기 위해 이 논문에서는 그래프 신경망(GNN)사용할 것을 제안합니다. 이 프레임워크는 예제를 통해 학습하고 디바이스 특성이나 네트워크 상태와 같은 다양한 요소를 살펴봄으로써 리소스를 할당하는 가장 좋은 방법을 알아낼 수 있다.

이 논문에서는 GNN 학습할 예제를 더 쉽게 만들 수 있도록 도와주는 교차 엔트로피(CE)라는 방법을 사용하는 방법에 대해서도 설명한다. 이는 프로그램에 좋은 리소스 할당이 어떤 모습인지에 대한 힌트를 주는 것과 같다.

간단히 말해, 무선 네트워크를 각 디바이스가 선으로 연결된 그래프로 표현할 수 있는 방법을 보여다. 이 그래프 표현은 기기가 서로 어떻게 연관되어 있고 서로 통신하는지 이해하는 데 도움이 된다..

이 프레임워크를 지도학습을 이용한 GNN을 함께 사용함으로써 속도와 효율성 측면에서 다른 방식에 비해 성능을 향상시키면서도 정확한 리소스 할당 결정을 내릴 수 있다.

</aside>

—# 교차 엔트로피

 교차 엔트로피는 **두 확률 분포가 서로 얼마나 다른지 측정한**다. 이 경우 대표 훈련 샘플을 효율적으로 생성하는 데 도움이 된다. 간단히 말해, 교**차 엔트로피는 GNN 프로그램을 효과적으로 훈련하기 위한 좋은 자원 배분**이 어떤 것인지 보여주는 예제를 만드는 데 도움이 된다. 또한 유익하고 관련성 높은 훈련 데이터를 제공하여 GNN 모델을 학습시키는 과정을 단순화하고 개선하는 데 도움을 준다.

크로스 엔트로피를 프레임워크의 일부로 사용하면 무선 IoT 네트워크 내에서 리소스 할당에 대해 더 나은 결정을 내리는 방법을 GNN 프로그램에 가르치는 데 도움이 되는 유용한 예제를 생성할 수 있다.

### *A. Training Samples Generation*

### **트레이닝 샘플 생성**

 무선 네트워크에서 리소스 할당을 위해 제안된 프레임워크는 supervised 방식으로 작동하며 레이블이 지정된 훈련 샘플에 의존한다. 그러나 **B&B 알고리즘**과 같은 최적의 알고리즘을 사용하여 **훈련 목적으로 대규모 데이터 세트를 생성하는 것은 계산적으로 복잡**하다. 이러한 문제를 해결하기 위해 **교차 엔트로피(CCE) 알고리즘을 사용하여 훈련 샘플을 생성함으로써 계산 복잡성과 시간 소비를 줄인다.**

Kullback-Leibler cross-entropy 와 중요도 샘플링을 기반으로 하는 CE 방법은 제안된 프레임워크에서 사용되는 반복적인 절차이다. 각 반복에서 지정된 메커니즘에 따라 **무작위 샘플이 생성**되고, 다음 반복에서 샘플을 개선하기 위해 **데이터를 기반으로 메커니즘의 매개변수가 업데이트**된다. 이 접근 방식은 훈련 샘플 생성을 단순화하고 무선 네트워크의 리소스 할당 문제에서 계산 복잡성과 시간 소비를 줄이는 데 도움이 된다.

1. 지정된 메커니즘에 따라 무작위 샘플을 생성
2. 다음 반복에서 더 나은 샘플을 위해 데이터를 기반으로 메커니즘의 파라미터를 업데이트

 일반적인 제약된 리소스 할당 문제를 해결하기 위해 제안된 프레임워크는 독립적인 베르누이 분포를 활용하여 무 작위 샘플을 생성하는 CCE 알고리즘을 채택한다. **이 알고리즘에는 샘플 생성, 실행 불가능한 샘플을 실행 가능한 샘플로 변환, 반복을 통해 최적에 가까운 결과를 얻는 등의 단계가 포함된다.** 이러한 최적에 가까운 결과는 다음 하위 섹션에서 GNN(그래프 신경망)의 훈련 레이블로 사용된다. 제안된 GNN(그래프 신경망) 접근 방식은 시뮬레이션에서 입증된 바와 같이 **대규모 네트워크의 훈련 문제를 처리하는 데 효율적이다**. CCE 알고리즘과 같은 최적의 알고리즘을 사용하여 훈련 데이터 세트를 생성할 수 있으므로 계산 복잡성과 시간 소비를 줄일 수 있다. 또한 GNN 모델의 일반화 가능성 덕분에 소규모 네트워크에서의 성능을 바탕으로 대규모 네트워크에도 적용할 수 있다.

<aside>
📍 **훈련 목적의 샘플을 생성하기 위하여 CCE알고리즘을 사용한다. 이 알고리즘을 사용하여 무작위로 샘플을 생성하고 실행 불가능한 샘플을 실행 가능한 샘플로 변환하고 반복을 통해 데이터를 기반으로 메커니즘의 파마미터를 업데이트한다.**

</aside>

### *B. Graph Representation of Wireless Networks*

### 무선 네트워크의 그래프 표현

 그래프는 추상적인 개념을 구조화된 방식으로 표현하는 방법으로, 다양한 요소 간의 관계와 상호 작용을 강조한다. 무선 네트워크의 경우 그래프를 사용하여 송신기와 수신기를 모델링하고 통신 링크와 간섭 링크를 각각 노드와 에지로 캡처할 수 있다. 이러한 그래프 표현을 통해 그래프 기반 기술을 적용하여 무선 네트워크의 다양한 문제를 효과적으로 해결할 수 있다. 무선 IoT 네트워크를 모델링할 때 그래프를 사용하면 그래프 기능에 기하학적 정보를 통합할 수 있다는 장점이 있다. 이 기능은 네트워크 요소 간의 공간적 관계와 상호 작용을 표현할 수 있으므로 무선 네트워크에서 송신기와 수신기를 모델링할 때 특히 유용하다. 무선 네트워크에는 에이전트 간의 통신 링크를 나타내는 **유익한 링크**와 서로 다른 에이전트 간의 간섭 링크를 나타내는 **유해한 링크**의 **두 가지 유형의 링크**가 있다. 이 두 가지 유형의 링크는 **서로 상반된 기능**을 하며, 통신 링크는 통신을 원활하게 하고 간섭 링크는 장애를 일으킨다. 이러한 유형의 링크를 이해하고 구분하는 것은 무선 네트워크 성능을 효과적으로 관리하고 간섭 문제를 완화하는 데 중요하다.무선 IoT 네트워크의 맥락에서 **통신 링크는 트랜시버 쌍 간의 연결**을 의미하며 **간섭 링크는 서로 다른 트랜시버 쌍 간의 상호 작용**을 나타낸다. 그래프 모델링에서 **이 두 가지 유형의 링크를 구분하는 것은** 네트워크 구조를 보다 정확하게 표현하고 그래프 기반 기술을 적용하여 무선 네트워크의 다양한 문제를 효과적으로 해결할 수 있도록 하기 때문에 **중요하다.** 무선 통신 시스템의 경우 시스템을 **방향성 그래프로 표현하여** 트랜시버 쌍 간의 **통신 링크를 노드로 취급**하고 **노드 간의 간섭 링크를 에지로 취급**한다고 설명한다. 이러한 그래프 기반 모델링을 통해 유익한 링크와 유해한 링크를 분리하고 구분할 수 있으므로 고급 그래프 기반 기술을 사용하여 무선 네트워크를 분석하고 최적화할 수 있다. 무선 네트워크에서 통신 링크와 관련된 거리, 채널 정보, 가중치, 우선순위와 같은 속성은 **노드 특성으로 간주**할 수 있다. 반면에 간섭 링크와 관련된 거리 및 채널 정보와 같은 속성은 **에지 피처로 취급**할 수 있다. 이러한 방식으로 무선 네트워크를 표현하면 그래프 컬러링 및 그래프 임베딩과 같은 고급 그래프 기반 기술을 사용하여 무선 네트워크의 다양하고 복잡한 문제를 효과적으로 해결할 수 있다.

<aside>
📍 **무선 네트워크에는 유익한 링크와 유해한 링크가 존재한다. 유익한 링크는 트랜시버 쌍 간의 연결을 의미하며 유해한 링크는 서로 다른 트랜시버 쌍 간의 상호작용을 의미한다. 유익한 링크는 노드로 유해한 노드는 엣지로 표현하여 그래프 구조를 적용할 수 있다.**

</aside>

그래프 구조 관점에서 V는 그래프에서 노드 집합을 나타내고 E는 에지 집합을 나타낸다. 두 노드 u와 v를 연결하는 에지는 e(u, v)로 표시되며, 무선 네트워크에서 이러한 에지는 방향성을 가지며 **한 노드에서 다른 노드로의 간섭을 나타낸다.** 또한 V와 E는 무선 네트워크의 맥락에서 각각 노드 특징과 에지 특징을 나타내는 데 사용된다. 무선 네트워크의 리소스 할당과 관련하여 원하는 직접 채널 **이득을 노드 특성**으로, **유해한** 간섭 채널 이득을 에**지 특성**으로 **모델링**하여 통신 링크와 간섭 링크의 기여도를 구분한다. 또한 제안된 프레임워크는 소규모 및 대규모 페이딩 효과를 모두 고려하여 채널 상태 정보(CSI)를 입력 피쳐로 활용한다. CSI는 벽과 같은 장애물로 인한 소규모 페이딩 효과와 거리로 인한 대규모 페이딩 효과를 모두 고려하여 특정 디바이스가 다른 디바이스로부터 신호를 얼마나 잘 수신하는지에 대한 정보를 제공한다. GNN을 통한 리소스 할당 결정에 CSI를 통합함으로써 무선 통신에 영향을 미치는 다양한 요인에 대한 포괄적인 지식을 바탕으로 보다 정보에 입각한 선택을 내릴 수 있도록 지원한다. 이러한 접근 방식은 리소스 할당 과정에서 통신 및 간섭과 관련된 정보를 효과적으로 포착하고 활용하는 것을 목표로 한다. 

<aside>
📍 **노드와 노드를 연결하는 엣지가 있는 경우 간섭이 있는것으로 나타내며 유익한 간섭은 노드특성으로 유해한 간섭은 엣지 특성으로 모델링하낟.**

</aside>

### *C. Graph Neural Network*

 그래프 신경망(GNN)은 각 노드가 인접 노드로부터 정보를 수집하고 이를 자신의 특징과 결합하는 다중 레이어로 구성된 모델이다. GNN은 집계 및 조합 연산을 통해 각 노드의 표현을 업데이트한다. 노드 v에서 m번째 레이어에 대한 업데이트 규칙은 이러한 연산에 의해 결정되므로 노드 표현을 반복적으로 세분화할 수 있다.

<img width="462" alt="3" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/5d5eba3e-d73b-4f9a-9ac6-989fd10fd9fb">


- α(m) v = AGGREGATE(m)({β(m-1) u : u ∈ N(v)})라는 방정식은 m번째 계층에서 인접 노드에서 노드 v까지의 특징의 합계를 나타낸다N(v) 집합은 노드 v의 이웃을 나타낸다.
- β(m) v는 이전 레이어에서 노드 v의 특징 벡터를 나타낸다. 이 방정식은 GNN에서 노드 특징을 결합하고 업데이트하는 프로세스를 강조하며, 사용된 특정 AGGREGATE 및 COMBINE 함수에 따라 달라질 수 있다.

GNN은 **CNN(컨볼루션 신경망)을 사용**하여 로컬 그래프 구조의 이웃에서 특징 정보를 집계함으로써 리소스 할당 작업에서 효과적인 분석과 의사 결정을 가능하게 한다. 그래프 신경망의 맥락에서 이웃 집계는 이웃 노드의 순서가 집계된 특징에 영향을 미치지 않는 순열 불변성의 속성을 갖는 것을 목표로 한다. 이 특성은 합계, 평균 또는 최대값과 같은 순열 불변 함수를 사용하여 인접 노드의 특징을 **단일 벡터로 결합함으로써 달성할 수 있다**. 이렇게 하면 집계된 이웃 노드 특징이 노드 순서에 관계없이 일관성을 유지한다.

<img width="353" alt="4" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/07f67a7e-0357-42f0-90ff-44523f8963d3">


평균 연산을 예로 제안된 GNN 업데이트 규칙은 이러한 연산을 통합하여 그래프에서 노드의 표현을 향상시킨다.

- α(m)v는 그래프 신경망(GNN)의 m번째 계층에 있는 노드 v의 이웃에서 집계된 정보를 나타내는 특징 벡터이다.  d1로 표시되는 α(m)v의 차원은 사용자가 정의하며 일반적으로 GNN에 사용되는 **컨볼루션 신경망(CNN)의 출력 채널과 동일**하다.
- β(m) v는 그래프 신경망(GNN)의 특정 계층에 있는 노드 v의 임베딩 특징 벡터를 나타낸다. R1×d2로 표시되는 β(m) v의 크기는 해결하려는 **문제의 클래스 수**에 따라 결정된다. 이는 GNN 모델에서 노드의 특징을 나타내는 역할을 한다.

그래프 신경망(GNN)의 마지막 계층에 있는 β(m) v는 그래프에서 학습된 특징과 정보를 캡처하는 GNN의 최종 출력을 나타낸다. E로 표시되는 평균 연산은 집계된 특징이 인접 노드의 순서에 불변하도록 보장하며, 순열 불변성이라는 속성을 제공한다. 이 속성을 통해 GNN은 인접 노드의 집합적 정보를 고려하여 그래프 데이터를 효과적으로 처리하고 분석할 수 있다.

 제안된 프레임워크에서는 심층 신경망(DNN)이 마지막 활성화 함수로 **소프트맥스 함수와 함께 사용된다**. 트랜시버 쌍 간의 통신 링크는 노드로 표현되며, 직접 채널 이득을 노드 특성으로 사용한다. 반면에 노드 간의 간섭 링크는 에지로 표현되며 간섭 채널 이득을 에지 기능으로 사용한다. 이 접근 방식을 사용하면 무선 IoT 네트워크에서 리소스 할당 문제를 모델링하고 해결할 수 있다.

 그래프 기반 모델에서 Vu는 이웃 노드 u의 노드 특징(직접 채널 이득)을 나타내고 Euv는 노드 u에서 노드 v까지의 에지 특징(간섭 채널 이득)을 나타낸다. 또한 β(0)v는 0 벡터로 초기화되며, 그 크기는 해결되는 특정 문제에 따라 달라진다. 이러한 특징과 초기화는 그래프 신경망 프레임워크의 후속 연산과 계산에 중요하다.

 그래프 신경망(GNN) 프레임워크에서는 **각 계층에서 변수 α와 β만 업데이트**하면 되고, **Vu와 Euv와 같은 다른 매개변수는 일정하게 유지된다.** 그림 2는 GNN의 한 노드가 주변 노드(노드 2~4와 그 에지)의 정보를 취합하고 이를 자신의 로컬 정보와 결합하는 과정을 보여준다. 이 과정은 GNN의 각 레이어에 대해 반복되어 노드 표현을 업데이트한다.  통신 및 간섭 링크와 관련된 속성을 그래프 영역에서 노드 및 에지 특징으로 표현할 수 있다. 이를 통해 네트워크 문제를 그래프 표현에 매핑하여 제안한 그래프 신경망(GNN) 프레임워크를 무선 IoT 네트워크에 적용할 수 있다. 즉, 네트워크의 통신 및 간섭 측면을 고려하여 무선 IoT 네트워크의 자원 할당 문제를 해결하는 데 GNN을 사용할 수 있다.

<img width="378" alt="5" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/35d3620e-3da7-47b7-bf7a-b51e830d21cc">

 **리소스 할당 문제**는 서로 다른 노드에 리소스를 할당하는 것이 목표인 **다중 클래스 분류 문제**로 볼 수 있다. 각 노드는 클래스와 연관되어 있으며, 그래프 신경망(GNN)의 출력은 각 노드가 특정 클래스에 속할 확률을 나타내는 뉴런으로 구성된다. 클래스의 수는 C로 표시되며, GNN 출력은 개별 노드에 대한 리소스 할당 결정을 결정하는 데 도움이 된다.  리소스 할당 문제에서 대상 레이블과 분류에 사용되는 표기법과 표현은 다음과 같다. 여기서 x는 각 노드에 대한 리소스 할당 결정을 나타내는 목표 레이블을 나타내고, y는 각 노드의 원핫 분류를 나타낸다. 각 노드에 대한 그래프 신경망(GNN)의 출력 클래스 확률은 ̃Y로 표시되며, 이는 각 노드가 특정 클래스에 할당될 확률을 나타낸다. 

 제안된 GNN 기반 프레임워크는 **전처리 및 후처리 단계를 통합**하여 다양한 문제에 맞게 사용자 정의할 수 있다. 이러한 단계는 선택 사항이며 실용적인 고려 사항과 전문 지식의 가용성에 따라 달라진다. 예를 들어, 그래프 표현은 거리 임계값을 설정하거나 고정된 수의 인접 노드를 고려하여 복잡성을 줄이기 위해 사전 처리될 수 있다. 후처리에는 투영 알고리즘, 전력 할당 또는 복구 기법 사용과 같은 전문 지식의 도움으로 제약 조건을 해결하거나 최종 목표를 달성하는 것이 포함될 수 있다. 이 프레임워크는 전처리 및 후처리 단계에 전문 지식을 통합하여 무선 네트워크의 리소스 할당 문제를 해결할 수 있는 가능성을 보여준다.

![6](https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/923c44d5-a3f7-4d65-905e-cc855770b863)

### 4. *Complexity of GNN*

### GNN의 복잡성

 무선 네트워크에서 그래프 모델링의 경우 학습할 노드 수(NV)와 각 노드의 이웃 수(NE)가 중요한 역할을 한다. 제안된 GNN(그래프 신경망)은 CNN(컨볼루션 신경망)과 DNN(심층 신경망)으로 구성되며, CNN의 시간 복잡도는 약 O(NV NE), DNN의 시간 복잡도는 약 O(NV)이다. 전반적으로 G 계층 GNN의 시간 복잡도는 G를 상수로 간주할 때 대략 O(NV NE)이다. 

---

## 4. APPLICATION ON LINK SCHEDULING PROBLEM IN D2D NETWORKS

### 2D 네트워크의 링크 스케줄링 문제에 대한 응용 프로그램

 이 섹션에서는 장치 간(D2D) 네트워크의 링크 스케줄링 문제를 해결하기 위해 지도 신경망(GNN) 프레임워크를 적용한다. 시뮬레이션 결과를 통해 접근 방식의 성능을 입증하고 무선 IoT 네트워크에서 링크 스케줄링 문제를 해결하는 데 제안된 프레임워크의 효율성을 보여준다.

### *A. System Model and Problem Formulation*

### 시스템 모델 및 문제 공식화

 사각형 영역에 무작위로 배치된 여러 개의 D2D 쌍으로 구성된 무선 IoT 네트워크를 고려하자. 각 D2D 쌍에는 송신기와 수신기가 있으며 동일한 스펙트럼을 공유한다. D2D 쌍은 특정 거리 범위 내에 있다고 가정하고 각 쌍의 전송 전력은 고정되어 있다. 이 네트워크 구성은 그림 3a에 나와 있다.

<img width="382" alt="7" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/d842e7bb-0662-4c17-89b5-6c94a72aa42e">


목표는 최적의 링크 스케줄링을 결정하여 합계 속도를 최대화하는 것

### *B. Graph Representation*

**

<img width="382" alt="8" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/aaba93c2-7c68-4d98-9479-cd186d05b3cc">

 D2D 무선 네트워크의 맥락에서 완전 연결 그래프 모델은 각 D2D 쌍을 노드로, 각 간섭 링크를 에지로 나타낸다. 채널 정보와 노드/에지 피처 간의 피처 매핑은 Vv = h11, Vu = h22, Euv = h21, Evu = h12와 같이 설정된다. 이 사례 연구에서 GNN의 목표는 채널 행렬을 각 D2D 쌍의 활성화 상태를 결정하는 이진 결정에 매핑하는 것이며, 그 결과 완전히 연결된 그래프 구조로 인해 시간 복잡도가 약 O(L^2)가 된다.

### *C. Numerical Results*

**수치결과**

 두 사례 연구 모두 인텔 코어 i5-9600KF CPU와 파이토치 프레임워크를 사용하여 시뮬레이션을 수행했다. 제안된 supervised GNN 프레임워크의 성능을 평가하고 4개의 벤치마크 체계와 비교했다.

- CCE: 훈련 샘플을 생성하기 위해 CCE 알고리즘을 사용하며, 이는 상한의 역할을 한다. 이 CCE 알고리즘에 대해 ML 기반 방식의 성능을 제공한다.
- Unsupervised GNN: Unsupervised GNN은 제안된 Supervised GNN과 동일한 구조와 매개 변수를 가지고 있으며 손실 함수는 [22]와 같이 음의 합율로 정의된다.
- 그래프 임베딩: 양자화가 있는 거리를 그래프 임베딩을 위한 노드 및 에지 특징으로 한다. 노드의 임베딩 특징은 [20]과 같이 3계층 분류기에 의해 지도 방식으로 학습된다.
- DNN: 4층의 종래의 지도형 DNN이 채택되고, 채널 행렬이 입력으로 받아들여진다.

 공정한 비교를 보장하기 위해 제안된 프레임워크 및 벤치마크 설계의 성능을 일관된 설정을 사용하여 평가다. 테스트 데이터 세트는 모든 시뮬레이션에 대해 **200개의 샘플로 구성**되며 ADAM 최적화기는 두 문제의 네트워크 파라미터를 업데이트하는 데 사용된다. **CCE 알고리즘은 평가를 위한 샘플을 생성하는 데 사용된다.**

언급된 사례 연구의 맥락에서, 제안된 방법 및 벤치마크 체계의 성능은 **평균 분류 정확도, 합율 및 시간 소모**의 세 가지 메트릭을 기반으로 평가된다. 분류 정확도는 제안된 설계 및 벤치마크 체계가 CCE 방법에 의해 생성된 목표와 **얼마나 잘 일치하는지 측정한다.** 평균 합율은 제안된 설계 및 벤치마크 체계가 CCE 알고리즘과 비교하여 **달성한 정규화된 합율을 반영한다**. 또한 제안된 프레임워크 및 벤치마크 체계의 실행 시간을 비교하기 위해 시간 소모가 고려된다.

 본 사례 연구에서는 사각형 영역 내에서 송신기와 수신기를 임의로 생성하여 D2D(Device-to-Device) 통신 시나리오를 시뮬레이션한다. 수신기들은 송신기들로부터 지정된 거리에서 균일하게 분포된다. 시뮬레이션은 대규모 페이딩을 위한 거리 의존적 경로 손실 모델과 소규모 페이딩을 위한 평균과 단위 분산이 0인 레일리 페이딩을 통합한다. 시뮬레이션에 사용된 구체적인 파라미터는 Table I에 나와 있다.

- 30개의 D2D(Device-to-Device) 쌍을 포함하는 특정 시나리오에 대해 다른 수의 훈련 샘플을 사용하여 지도 그래프 신경망(GNN) 접근 방식의 성능의 결과는 제안된 지도 GNN이 **100개의 훈련 샘플**만으로 **0.9027의 정확도와 0.9724의 정규화된 합을 달성**하고 더 많은 수의 훈련 샘플로 성능이 향상됨을 보여준다. 특히 **1000개의 훈련 샘플**을 사용하면 **정확도와 합율이 각각 0.9277과 0.9827로 증가**하여 더 많은 훈련 데이터로 성능이 향상되었음을 나타낸다.
    
    <img width="329" alt="9" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/9dbb6ba8-5b56-48a3-9a54-99c9a4bdbfce">

    
- **표 II**는 제안된 **supervised GNN** 방법이 벤치마크 방식보다 더 나은 성능을 보임을 보여준다. 이는 **supervised GNN이 D2D 링크 스케줄링의 이산 분류 문제에 더 적합**한 반면, **비지도 GNN은 더 나은 성능을 달성하기 위해 더 많은 샘플을 필요로** 하기 때문이다. 또한, 제안된 지도 GNN은 거리 정보만 고려하는 후자와 달리 소규모 페이딩 정보를 통합하기 때문에 그래프 임베딩 방법보다 성능이 뛰어난다. 기존의 지도 DNN은 대규모 훈련 데이터 세트를 필요로 하고 그래프 이론에서 노드/엣지 특징을 무시하기 때문에 가장 성능이 좋지 않다.
    
    <img width="692" alt="10" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/1c03776c-7dd2-4d47-b426-af0fc08f3e25">
    
- 다양한 수의 장치 대 장치(D2D) 쌍을 갖는 무선 네트워크 시나리오에 대해 제안된 방법의 성능 평가는 다음과 같다. **제안된 GNN(지도 그래프 신경망) 접근법은 10, 30, 50개의 D2D 쌍에 대한 FPLinQ 알고리즘에 비해 각각 0.83%, 2.33%, 2.44%의 향상을 달성**합니다. 결과는 제안된 접근법이 시스템 규모가 증가함에 따라 최상의 성능과 가장 안정적인 성능을 유지하여 벤치마크 설계를 능가하고 대규모 시스템을 처리할 수 있는 능력을 입증함을 보여준다.
    
    <img width="532" alt="11" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/fbb20469-2a80-4bdd-bedc-5d59b19616bb">

    
- 표 IV에 제시된 결과는 200개의 훈련 샘플 및 30개의 D2D 쌍을 사용하여 제안된 방법이 목표 스케줄링 결과와 비교하여 최소 **88%의 정확도를 달성**하고 **평균 정규화 합률은 CCE 알고리즘에 의해 달성된 것의 96% 이상을 유지함을 보여준다**. 이는 제안된 방법이 쌍별 거리 분포의 변화에 강하여 높은 성능 수준을 유지함을 나타낸다.
    
    <img width="656" alt="12" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/57af76ce-9de9-4ea1-90f3-3ad774d5cbf0">
    
- 지도 GNN(Graph Neural Network)과 벤치마크 방식의 러닝타임 성능은 서로 다른 시스템 스케일(L = 10, 30, 50)과 쌍방향 거리(2-65 m)의 네트워크 설정에서 비교된다. 평균 러닝타임은 표 V에 제시되어 있으며, 지도 GNN은 기존 알고리즘에 비해 D2D 네트워크에서 링크 스케줄링 문제를 수천 배 이상 빠르게 가속함을 보여준다. 이러한 러닝타임 향상은 지도 GNN 접근 방식을 무선 네트워크에서 실시간 구현을 유망하게 한다.
    
    <img width="344" alt="13" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/51c37f8d-939b-4c3b-a9e5-6867c085a503">
    

D2D 링크 스케줄링을 위한 기존의 CCE 방법은 시간이 많이 소요되며 무선 네트워크의 실시간 응용에 적합하지 않다. 반면  Supervidsd GNN 방법은 링크 스케줄링 문제를 크게 가속화하여 L=10의 경우 CCE보다 약 10^4배, L=30의 경우 3×10^4배 빠르다. 이는 러닝 타임 측면에서 FPLinQ 알고리즘과 그래프 임베딩 방법을 능가하며, DNN은 러닝 타임 성능은 우수하지만 종단 성능 및 샘플 효율성이 GNN 기반 설계에 비해 떨어진다.

다양한 시스템 설정에서 제안된 GNN(Graph Neural Network) 프레임워크의 일반화 가능성에 대해 설명한다. 1000개의 샘플로 훈련된 GNN 모델은 추가 훈련 없이 쌍별 거리와 시스템 스케일이 다양한 시나리오에 적용된다. 결과는 GNN 접근 방식이 감독되지 않은 GNN 및 그래프 임베딩 방법을 능가하는 다양한 설정에서 안정적인 성능을 보여주는 반면, DNN(Deep Neural Network)은 네트워크 스케일이 변경될 때 재교육이 필요하다는 것을 보여준다.

<img width="729" alt="14" src="https://github.com/junyong1111/AlphaProject-GNN/assets/79856225/37412d83-41da-4335-ac97-5a07b3a08351">

연구에서 저자는 제안된 GNN(Graph Neural Network) 프레임워크를 추가 교육 없이 다른 네트워크 스케일로 일반화할 수 있으므로 무선 IoT 네트워크에서 비용이 많이 드는 재교육을 피할 수 있다는 점을 강조한다. 또한 손상된 입력 기능에 대한 GNN 프레임워크의 견고성을 입증하여 채널 상태 정보(CSI)의 50%가 누락된 경우에도 GNN은 전체 CSI를 가진 경우에 비해 0.85의 정확도와 0.91의 합율을 달성한다는 것을 보여준다.

| 사례 연구 내용 | 주요 결론 및 결과 |
| --- | --- |
| 사용된 하드웨어 및 소프트웨어 | - 인텔 코어 i5-9600KF CPU
- 파이토치 프레임워크 |
| 비교 대상 및 벤치마크 체계 | - 제안된 Supervised GNN vs. CCE 알고리즘
- Unsupervised GNN
- 그래프 임베딩
- DNN |
| 성능 평가 메트릭 | - 평균 분류 정확도
- 합율
- 시간 소모 |
| 테스트 데이터 세트 구성 | - 200개의 샘플로 구성 |
| 사용된 최적화 기법 | - ADAM 최적화기 |
| CCE 알고리즘 활용 | - 평가를 위한 샘플 생성에 사용 |
| Supervised GNN 훈련 결과 (예시) | - 100개의 훈련 샘플: 정확도 0.9027, 합율 0.9724
- 1000개의 훈련 샘플: 정확도 0.9277, 합율 0.9827 |
| 제안된 GNN vs. CCE 성능 비교 (예시) | - 30개의 D2D 쌍: GNN 성능 향상 (최대 2.44%)
- L=10, 30, 50: GNN 러닝타임 압도적으로 빠름
- 200개의 훈련 샘플 및 30개의 D2D 쌍: GNN이 88% 이상의 정확도와 96% 이상의 합율 달성 |
| GNN의 일반화 가능성에 대한 연구 | - 1000개의 훈련 샘플로 훈련된 GNN이 다양한 설정에서 안정적인 성능 유지- 재교육 없이 다른 네트워크 스케일로 일반화 가능 |
| GNN의 견고성에 대한 연구 | - 50%의 채널 상태 정보(CSI) 손실 시에도 GNN이 높은 성능 달성 |

---

## 5. CONCLUSION

### 결론

 본 연구에서는 무선 IoT 시스템을 표현하기 위해 **그래프 모델링을 활용한 프레임워크를 제안**하며, 무선 IoT 네트워크에서 자원 할당을 최적화하기 위해 **합성곱 신경망(CNN)과 심층 신경망(DNN)을 결합한** 일반적인 그래프 신경망(GNN) 접근법을 소개한다. 프레임워크는 특징 집합을 위해 CNN을 사용하고 특징 결합을 위해 DNN을 사용하여 그래프 내 각 노드의 특징 벡터를 반복적으로 업데이트한다.

또한 D2D(Device to Device) 무선 네트워크에서 자원 할당을 위해 제안된 프레임워크의 성능 평가시뮬레이션 결과는 프레임워크가 동종 시스템에서 효과적으로 수행되며 이종 네트워크를 처리할 수 있는 가능성을 보여준다. 이는 제안된 프레임워크가 무선 IoT 네트워크에서 실제 구현을 위한 유망한 솔루션이 될 수 있음을 시사한다.

 논문에서 제안한 GNN 프레임워크는 다른 벤치마크 방식에 비해 **우수한 성능**을 보여 **무선 IoT 네트워크에서 실시간 구현을 위한 유망한 선택**이다. 또한 프레임워크는 다양한 네트워크 설정에 일반화 가능성과 손상된 입력 기능에 대한 복원력을 보여 실제 시나리오에서의 적용 가능성과 견고성을 강화한다.